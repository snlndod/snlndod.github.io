<!doctype html>



  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="HANA,">








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0">






<meta name="description" content="In-memory database technology is a core feature of the SAP HANA database, which enables new applications that were not possible before. Impact of Modern Hardware on Database System ArchitectureIn the">
<meta name="keywords" content="HANA">
<meta property="og:type" content="article">
<meta property="og:title" content="Basic In-Memory Database Concepts">
<meta property="og:url" content="http://yoursite.com/2019/07/01/Basic-In-Memory-Database-Concepts/index.html">
<meta property="og:site_name" content="SDE PREPARES">
<meta property="og:description" content="In-memory database technology is a core feature of the SAP HANA database, which enables new applications that were not possible before. Impact of Modern Hardware on Database System ArchitectureIn the">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://raw.githubusercontent.com/snlndod/mPOST/master/HANA/2-1.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/snlndod/mPOST/master/HANA/2-2.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/snlndod/mPOST/master/HANA/2-3.jpg">
<meta property="og:updated_time" content="2021-05-28T15:48:07.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Basic In-Memory Database Concepts">
<meta name="twitter:description" content="In-memory database technology is a core feature of the SAP HANA database, which enables new applications that were not possible before. Impact of Modern Hardware on Database System ArchitectureIn the">
<meta name="twitter:image" content="https://raw.githubusercontent.com/snlndod/mPOST/master/HANA/2-1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/07/01/Basic-In-Memory-Database-Concepts/">





  <title> Basic In-Memory Database Concepts | SDE PREPARES </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  














  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">SDE PREPARES</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/01/Basic-In-Memory-Database-Concepts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="umarellyh">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SDE PREPARES">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Basic In-Memory Database Concepts
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-01T23:50:05+08:00">
                2019-07-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><code>In-memory database technology</code> is a core feature of the SAP HANA database, which enables new applications that were not possible before.</p>
<h2 id="Impact-of-Modern-Hardware-on-Database-System-Architecture"><a href="#Impact-of-Modern-Hardware-on-Database-System-Architecture" class="headerlink" title="Impact of Modern Hardware on Database System Architecture"></a>Impact of Modern Hardware on Database System Architecture</h2><p>In the past database management systems were designed for optimizing performance on hardware with limited main memory and with slow disk I/O as the main bottleneck. The focus was on <strong>optimizing disk access</strong>, for example by minimizing the number of disk pages to be read into main memory when processing a query.<br>Today’s computer architectures have changed. With <code>multi-core processors</code>, parallel processing is possible with fast communication between processor cores. Very large main memory configurations are now commercially available and affordable.<br>With all relevant data in memory, disk access is no longer a limiting factor for performance. With the increasing number of cores, CPUs are able to process more and more data per time interval. That means the performance bottleneck is now <strong>between the CPU cache and main memory</strong>.<br><img src="https://raw.githubusercontent.com/snlndod/mPOST/master/HANA/2-1.jpg" alt><br>A <code>high performance data management system</code> for modern hardware must have the following characteristics:</p>
<a id="more"></a>
<ul>
<li>In-memory database<br>All relevant data must be kept in main memory, so read operations can be executed without disk I/O. <strong>Disk storage</strong> is still needed to make changes durable.</li>
<li>Cache aware memory organization, optimization and execution<br>The design must minimize the number of CPU cache misses and avoid CPU stalls because of memory access. One approach for achieving this goal is using <strong>column-based storage</strong> in memory. This leads to high spatial locality of data and instructions, so the operations can be executed completely in the CPU cache without costly random memory accesses.</li>
<li>Support for parallel execution<br>In recent years CPUs did not become faster by increasing clock rates. Instead the number of processor cores was increased. For data management systems this means that it must be possible to <strong>partition data in sections</strong> for which the calculations can be executed in parallel.</li>
</ul>
<h2 id="Columnar-and-Row-Based-Data-Storage"><a href="#Columnar-and-Row-Based-Data-Storage" class="headerlink" title="Columnar and Row-Based Data Storage"></a>Columnar and Row-Based Data Storage</h2><p>For storing a table in linear memory, two options can be chosen. A row store stores a sequence of records that contains the fields of one row in the table. In a column store, the entries of column are stored in contiguous memory locations.<br><img src="https://raw.githubusercontent.com/snlndod/mPOST/master/HANA/2-2.jpg" alt></p>
<h3 id="Choosing-Between-Column-and-Row-Store"><a href="#Choosing-Between-Column-and-Row-Store" class="headerlink" title="Choosing Between Column and Row Store"></a>Choosing Between Column and Row Store</h3><p>Column-based tables have advantages if:</p>
<ul>
<li>Calculations are typically executed on single of few columns only.</li>
<li>The table is searched based on values of a few columns.</li>
<li>The table has a big number of columns.</li>
<li>The table has a big number of rows and columnar operations are required (aggregate, scan, …).</li>
<li><strong>High compression rate</strong> can be achieved because the majority of the columns contain only a few distinct values.</li>
</ul>
<p>Row-based tables have advantages if:</p>
<ul>
<li>The application needs to process only one single record at one time.</li>
<li>The application typically needs to <strong>access the complete record</strong>.</li>
<li>The columns contain mainly distinct values so the data compression rate would be low.</li>
<li>Neither aggregations nor <strong>fast search</strong> are required.</li>
<li>The table has a small number of rows.</li>
</ul>
<h3 id="Advantages-of-Columnar-Tables"><a href="#Advantages-of-Columnar-Tables" class="headerlink" title="Advantages of Columnar Tables"></a>Advantages of Columnar Tables</h3><h4 id="Higher-Data-Compression-Rates"><a href="#Higher-Data-Compression-Rates" class="headerlink" title="Higher Data Compression Rates"></a>Higher Data Compression Rates</h4><p>The goal to keep all relevant data in main memory can be achieved with lower cost because <strong>data compression</strong> is used. Columnar data storage allows highly efficient compression. Especially if the column is sorted, there will be ranges of the same values in contiguous memory, so compression methods such as run length encoding or cluster encoding can be used more effectively.</p>
<h4 id="Higher-Performance-for-Column-Operations"><a href="#Higher-Performance-for-Column-Operations" class="headerlink" title="Higher Performance for Column Operations"></a>Higher Performance for Column Operations</h4><p>With columnar data organization, operation on single columns, such as searching or aggregations can be implemented as loops over an array stored in contiguous memory locations.<br>Higher data compression rate not only saves memory but also increases speed for the following reasons:</p>
<ul>
<li>Compressed data can be loaded faster into the CPU cache. As the limiting factor is the data transport between memory and CPU cache, the performance gain <strong>exceeds the additional computing time needed for decompression</strong>.</li>
<li>With <strong>dictionary encoding</strong>, the columns are stored as arrays of bit encoded integers. That means that check for equality can be executed on the integers. This is much faster than comparing for example string values.</li>
<li>Compression can speed up operations such as scans and aggregations if the operator is aware of the compression. Given a good compression rate, computing the sum of the values in a column will be much faster if many additions of the same value can be <strong>replaced by a single multiplication</strong>.</li>
</ul>
<h4 id="Elimination-of-Additional-Indexes"><a href="#Elimination-of-Additional-Indexes" class="headerlink" title="Elimination of Additional Indexes"></a>Elimination of Additional Indexes</h4><p>Storing data in columns already works like having a built-in index for each column. In many cases it will <strong>not be required to have addition index structures</strong>. Eliminating indexes reduces memory size, can improve write performance, and reduces development efforts.</p>
<h4 id="Elimination-of-Materialized-Aggregates"><a href="#Elimination-of-Materialized-Aggregates" class="headerlink" title="Elimination of Materialized Aggregates"></a>Elimination of Materialized Aggregates</h4><p>Traditional business applications use <code>materialized aggregates</code> to increase read performance. That means that the application developers define additional tables in which the application redundantly stores the results of aggregates computed on other tables.<br>SAP HANA eliminates the need for materialized aggregates in many cases. Financial applications, for instance, can compute totals and balances from the accounting documents when they are queried, <strong>instead of maintaining them as materialized values</strong>.<br>Eliminating materialized aggregates has several advantages:</p>
<ul>
<li>It simplifies data model and aggregation logic, which makes development and maintenance <strong>more efficient</strong>.</li>
<li>It allows for <strong>a higher level of concurrency</strong> because write operations do not require exclusive locks for updating aggregated values.</li>
<li>It ensures that the aggregated values are <strong>always up-to-date</strong>, while materialized aggregates are sometimes updated only at scheduled times.</li>
</ul>
<h4 id="Parallelization"><a href="#Parallelization" class="headerlink" title="Parallelization"></a>Parallelization</h4><p><code>Column-based storage</code> also simplifies parallel execution using multiple processor cores. That means operations on different columns can easily be processed in parallel.<br><img src="https://raw.githubusercontent.com/snlndod/mPOST/master/HANA/2-3.jpg" alt><br>If multiple columns <strong>need to be searched or aggregated</strong>, each of these operations can be assigned to a different processor core. In addition, the execution of operations on one column can be parallelized by dividing the column into multiple sections that are processed by different processor cores.</p>
<h2 id="History-Tables"><a href="#History-Tables" class="headerlink" title="History Tables"></a>History Tables</h2><p>SAP HANA supports history tables which allow queries on historical data. Applications may use this feature for example <strong>for time-based reporting and analysis</strong>. Write operations on history tables do not physically overwrite existing records. Instead, write operations always <strong>insert new versions</strong> of the data record into the database. Each row in a history table has <strong>timestamp-like system attributes</strong> that indicate the time period when the record version in this row was the current one.<br>In literature, data with time-based validity or visibility is known as <code>temporal data</code>. The standard distinguishes two levels of temporal data support, which can be characterized as <strong>system-versioned</strong> and as <strong>application-managed</strong>.<br>For system-versioned temporal data, the timestamps are <strong>automatically set</strong> and indicate the so-called transaction time when the data was current. New versions are automatically created by the system during updates. Application-managed is different, the time period indicates the period of validity on <strong>application level</strong>.</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/HANA/" rel="tag"># HANA</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/06/30/SAP-HANA-Overview/" rel="next" title="SAP HANA Overview">
                <i class="fa fa-chevron-left"></i> SAP HANA Overview
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/07/04/SAP-HANA-System-Architecture-Overview/" rel="prev" title="SAP HANA System Architecture Overview">
                SAP HANA System Architecture Overview <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="umarellyh">
          <p class="site-author-name" itemprop="name">umarellyh</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">213</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/snlndod" target="_blank" title="GitHub">
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/snlndod" target="_blank" title="LinkedIn">
                  
                  LinkedIn
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Impact-of-Modern-Hardware-on-Database-System-Architecture"><span class="nav-number">1.</span> <span class="nav-text">Impact of Modern Hardware on Database System Architecture</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Columnar-and-Row-Based-Data-Storage"><span class="nav-number">2.</span> <span class="nav-text">Columnar and Row-Based Data Storage</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Choosing-Between-Column-and-Row-Store"><span class="nav-number">2.1.</span> <span class="nav-text">Choosing Between Column and Row Store</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Advantages-of-Columnar-Tables"><span class="nav-number">2.2.</span> <span class="nav-text">Advantages of Columnar Tables</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Higher-Data-Compression-Rates"><span class="nav-number">2.2.1.</span> <span class="nav-text">Higher Data Compression Rates</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Higher-Performance-for-Column-Operations"><span class="nav-number">2.2.2.</span> <span class="nav-text">Higher Performance for Column Operations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Elimination-of-Additional-Indexes"><span class="nav-number">2.2.3.</span> <span class="nav-text">Elimination of Additional Indexes</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Elimination-of-Materialized-Aggregates"><span class="nav-number">2.2.4.</span> <span class="nav-text">Elimination of Materialized Aggregates</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Parallelization"><span class="nav-number">2.2.5.</span> <span class="nav-text">Parallelization</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#History-Tables"><span class="nav-number">3.</span> <span class="nav-text">History Tables</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">umarellyh</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="local-search-pop-overlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


  

  

  

  


  

</body>
</html>
